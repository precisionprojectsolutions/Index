<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <title>Vendor Portal | Precision Project Solutions</title>
    <meta name="description" content="Vendor registration and verified vendor database.">
    
    <link rel="icon" type="image/png" sizes="32x32" href="logo.jpg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

    <style>
        /* ==================================================
           GLOBAL & LAYOUT STYLES
        =================================================== */
        :root {
          --color-primary: #1f2c45; 
          --color-secondary: #212534; 
          --color-accent: #fcca3e; 
          --color-accent-hover: #ffd86e; 
          --color-light: #ffffff;
          --color-bg: #f8f9fb;
          --font-main: 'Outfit', sans-serif;
          --shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        html { scroll-behavior: smooth; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: var(--font-main); background: var(--color-bg); color: var(--color-secondary); line-height: 1.7; }
        
        .container { max-width: 1100px; margin: 0 auto; padding: 4em 2em; }
        h1, h2, h3 { color: var(--color-primary); font-weight: 600; }
        h2 { font-size: 2.4rem; text-align: center; margin-bottom: 1.5em; position: relative;}
        h2::after { content: ''; display: block; width: 60px; height: 4px; background: var(--color-accent); margin: 0.5em auto 0; border-radius: 2px; }

        /* Navigation */
        .main-header { background: var(--color-light); display: flex; justify-content: space-between; align-items: center; padding: 1.2em 2em; position: sticky; top: 0; z-index: 1000; box-shadow: var(--shadow); height: 80px; }
        .logo-box { display: flex; align-items: center; gap: 0.8em; }
        .logo-link { display: flex; align-items: center; gap: 0.8em; text-decoration: none; }
        .logo-box img { height: 50px; border-radius: 8px; }
        .logo-title { font-weight: 700; font-size: 1.5rem; color: var(--color-primary); }
        .main-nav { display: flex; gap: 2em; }
        .main-nav a { color: var(--color-secondary); text-decoration: none; font-weight: 600; transition: color 0.3s; position: relative; padding-bottom: 5px; }
        .main-nav a:hover, .main-nav a.active { color: var(--color-primary); }
        .main-nav a:hover::after, .main-nav a.active::after { content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 3px; background: var(--color-accent); }
        .menu-toggle { display: none; background: none; border: none; font-size: 2rem; cursor: pointer; color: var(--color-primary); }

        /* Page Header */
        .page-header { background: linear-gradient(rgba(31,44,69,0.9), rgba(31,44,69,0.8)), url('https://images.unsplash.com/photo-1556761175-5973dc0f32e7?auto=format&fit=crop&w=1600&q=80'); background-size: cover; background-position: center; color: var(--color-light); padding: 6em 2em 4em; text-align: center; margin-bottom: 2em; }
        .page-header h1 { font-size: 3rem; margin-bottom: 0.2em; color: #fff; }
        .page-header p { color: #eee; }

        /* ==================================================
           DATABASE & PAGINATION STYLES
        =================================================== */
        .db-controls {
            display: flex; gap: 1em; margin-bottom: 1.5em; flex-wrap: wrap; justify-content: space-between;
            background: var(--color-light); padding: 1.5em; border-radius: 12px; box-shadow: var(--shadow);
            align-items: center;
        }
        .control-group { display: flex; gap: 1em; flex: 1; min-width: 200px; }
        
        /* Adjusted Search Group to take full width available */
        .search-group { flex: 10; } 
        
        .db-input {
            width: 100%; padding: 0.8em 1em; border: 2px solid #eee; border-radius: 8px;
            font-family: var(--font-main); font-size: 1rem; outline: none; transition: border-color 0.3s;
        }
        .db-input:focus { border-color: var(--color-primary); }
        .db-label { font-weight: 600; font-size: 0.9rem; margin-bottom: 0.3em; display: block; color: #666; }

        .table-container { overflow-x: auto; border-radius: 12px; box-shadow: var(--shadow); background: var(--color-light); min-height: 400px; }
        .vendor-table { width: 100%; border-collapse: collapse; min-width: 800px; }
        .vendor-table thead { background: var(--color-primary); color: var(--color-light); }
        .vendor-table th, .vendor-table td { padding: 1.2em 1.5em; text-align: left; }
        .vendor-table tbody tr { border-bottom: 1px solid #eee; transition: background 0.2s; }
        .vendor-table tbody tr:hover { background: #fdfdfd; }
        
        .v-name { font-weight: 700; color: var(--color-primary); }
        .badge { padding: 0.4em 1em; border-radius: 50px; font-size: 0.8rem; font-weight: 700; text-transform: uppercase; }
        .badge-verified { background: #e3f9e5; color: #1b5e20; }
        .badge-pending { background: #fff8e1; color: #f57f17; }
        .badge-new { background: #e3f2fd; color: #0d47a1; }

        /* --- BUTTON STYLES --- */
        .btn-view {
            background: transparent;
            border: 2px solid var(--color-primary);
            color: var(--color-primary);
            padding: 0.5em 1.2em;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        .btn-view:hover {
            background: var(--color-primary);
            color: var(--color-light);
            box-shadow: 0 4px 10px rgba(31, 44, 69, 0.2);
        }

        /* --- MODAL (POPUP) STYLES --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); z-index: 2000;
            display: none; /* Hidden by default */
            justify-content: center; align-items: center;
            backdrop-filter: blur(3px);
        }
        .modal-box {
            background: white; width: 90%; max-width: 500px;
            padding: 2.5em; border-radius: 12px;
            text-align: center; position: relative;
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            animation: popIn 0.3s ease-out;
        }
        @keyframes popIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .close-modal {
            position: absolute; top: 15px; right: 20px;
            font-size: 1.5rem; cursor: pointer; color: #888;
        }
        .modal-title { font-size: 1.6rem; margin-bottom: 0.5em; color: var(--color-primary); }
        .modal-text { color: #555; margin-bottom: 2em; }
        .btn-modal {
            background: var(--color-accent); color: var(--color-primary);
            padding: 1em 2em; text-decoration: none; border-radius: 8px;
            font-weight: 700; display: inline-block; transition: 0.3s;
        }
        .btn-modal:hover { background: var(--color-accent-hover); transform: translateY(-2px); }

        /* Pagination */
        .pagination-wrapper { display: flex; justify-content: space-between; align-items: center; padding: 1.5em 0; margin-top: 1em; flex-wrap: wrap; gap: 1em; }
        .page-info { color: #666; font-size: 0.95rem; }
        .pagination-controls { display: flex; gap: 0.5em; }
        .page-btn { background: var(--color-light); border: 1px solid #ddd; color: var(--color-primary); width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-weight: 600; transition: all 0.3s; }
        .page-btn:hover { background: #eee; }
        .page-btn.active { background: var(--color-accent); border-color: var(--color-accent); color: var(--color-primary); transform: scale(1.1); }
        .page-btn:disabled { opacity: 0.5; cursor: not-allowed; }

        /* Footer */
        .main-footer { background: var(--color-primary); color: #ccc; padding: 3em 2em; margin-top: 4em; text-align: center; }
        .form-wrapper { background: var(--color-light); padding: 2em; border-radius: 12px; box-shadow: var(--shadow); text-align: center; margin-top: 4em; }
        .responsive-iframe-container { position: relative; padding-bottom: 100%; height: 0; overflow: hidden; max-width: 100%; }
        .responsive-iframe-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }

        @media (max-width: 768px) {
            .db-controls { flex-direction: column; align-items: stretch; }
            .pagination-wrapper { flex-direction: column; justify-content: center; }
            .main-nav { display: none; } 
            .menu-toggle { display: block; }
        }
    </style>
</head>
<body>

<header class="main-header">
    <div class="logo-box">
        <a href="index.html" class="logo-link">
            <img src="logo.jpg" alt="Precision Project Solutions Logo" />
            <span class="logo-title">Precision Project Solutions</span>
        </a>
    </div>
    <nav class="main-nav" id="main-nav">
        <a href="index.html">Home</a>
        <a href="about.html">About</a>
        <a href="services.html">Services</a>
        <a href="vendors.html" class="active">Vendors</a>
        <a href="contact.html">Contact</a>
    </nav>
    <button class="menu-toggle" aria-label="Open menu">&#9776;</button>
</header>

<main>
    <section class="page-header" data-aos="fade-in">
        <h1>Vendor Portal</h1>
        <p>Verified Database & Registration</p>
    </section>

    <div class="container">
        
        <section id="database" data-aos="fade-up">
            <h2>Vendor Database</h2>

            <div class="db-controls">
                <div style="flex: 0 0 120px;">
                    <label class="db-label">Show Rows</label>
                    <select id="rowsPerPage" class="db-input">
                        <option value="25">25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </div>
                
                <div class="control-group search-group">
                    <div style="width: 100%">
                        <label class="db-label">Search</label>
                        <input type="text" id="searchInput" class="db-input" placeholder="Search name or location...">
                    </div>
                </div>
            </div>

            <div class="table-container">
                <table class="vendor-table" id="vendorTable">
                    <thead>
                        <tr>
                            <th>Company / ID</th>
                            <th>Category</th>
                            <th>Location</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <tr><td colspan="5" style="text-align:center;">Loading data...</td></tr>
                    </tbody>
                </table>
                <div id="noResults" style="display:none; text-align:center; padding: 2em; color: #777;">
                    No results found.
                </div>
            </div>

            <div class="pagination-wrapper">
                <div class="page-info" id="pageInfo">Showing 0 entries</div>
                <div class="pagination-controls" id="paginationBtnContainer"></div>
            </div>
        </section>

        <div style="margin: 4em 0; border-top: 1px solid #ddd;"></div>

        <section id="register" data-aos="fade-up">
            <h2>Vendor Registration</h2>
            <div class="form-wrapper">
                <div class="responsive-iframe-container">
                    
                    <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSd2i9-sffF8EdTbklh0gby9zoxxUgY1OczaimuCpvp-rQioTA/viewform?embedded=true" 
                        width="640" height="800" frameborder="0" marginheight="0" marginwidth="0">Loading‚Ä¶</iframe>
                    
                </div>
            </div>
        </section>

    </div>
</main>

<footer class="main-footer">
    <p>&copy; 2025 Precision Project Solutions.</p>
</footer>

<div class="modal-overlay" id="leadModal">
    <div class="modal-box">
        <span class="close-modal" onclick="closeModal()">&times;</span>
        <h3 class="modal-title">Unlock Vendor Details</h3>
        <p class="modal-text">
            Access to contact numbers and email addresses is available for <b>FREE</b> to registered users.
            <br><br>
            Please register your inquiry to view full details instantly.
        </p>
        
        <a href="https://docs.google.com/forms/d/e/1FAIpQLSfD_YOUR_CLIENT_FORM_ID/viewform" target="_blank" class="btn-modal">
            Register for Free Access
        </a>
    </div>
</div>

<script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script>
    AOS.init({ offset: 100, duration: 800, once: true });

    // =========================================================
    // !!! CHANGE THIS TO YOUR CSV LINK !!!
    // =========================================================
    const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT7D7v6hix-Defu4Y0SJz1cWBFq-2BiiyGgSteygTdrfN3kz5VRvfdvAS28_ZJZywX4VJtaSlZPyu7w/pub?output=csv";

    // --- LOGIC ---
    const tableBody = document.getElementById('tableBody');
    const searchInput = document.getElementById('searchInput');
    const rowsPerPageSelect = document.getElementById('rowsPerPage');
    const paginationContainer = document.getElementById('paginationBtnContainer');
    const pageInfo = document.getElementById('pageInfo');
    const noResults = document.getElementById('noResults');
    const modal = document.getElementById('leadModal');

    let allRows = [];
    let currentFilteredRows = [];
    let currentPage = 1;
    let rowsPerPage = parseInt(rowsPerPageSelect.value);

    // Modal Logic
    function openModal() {
        modal.style.display = 'flex';
    }
    function closeModal() {
        modal.style.display = 'none';
    }
    // Close modal if clicking outside the box
    window.onclick = function(event) {
        if (event.target == modal) {
            closeModal();
        }
    }

    function loadSheetData() {
        Papa.parse(SHEET_URL, {
            download: true,
            header: true, 
            complete: function(results) {
                const data = results.data;
                tableBody.innerHTML = '';
                allRows = [];

                data.forEach(item => {
                    if(!item.Name) return; 

                    const tr = document.createElement('tr');
                    
                    let badgeClass = 'badge-pending';
                    if(item.Status && item.Status.toLowerCase() === 'verified') badgeClass = 'badge-verified';
                    if(item.Status && item.Status.toLowerCase() === 'new') badgeClass = 'badge-new';

                    tr.innerHTML = `
                        <td>
                            <div class="v-name">${item.Name}</div>
                            <small>ID: ${item.ID || ''}</small>
                        </td>
                        <td style="text-transform:capitalize">${item.Category || ''}</td>
                        <td>üìç ${item.Location || ''}</td>
                        <td><span class="badge ${badgeClass}">${item.Status || 'Pending'}</span></td>
                        <td>
                            <button class="btn-view" onclick="openModal()">
                                Get Details <span style="font-size:0.8em; color: green;">(Free)</span>
                            </button>
                        </td>
                    `;
                    allRows.push(tr);
                });
                updateTableLogic();
            },
            error: function(err) {
                console.error("Error:", err);
                tableBody.innerHTML = '<tr><td colspan="5" style="text-align:center; color:red;">Could not load data. Check CSV link.</td></tr>';
            }
        });
    }

    function updateTableLogic() {
        const searchTerm = searchInput.value.toLowerCase();
        
        currentFilteredRows = allRows.filter(row => {
            const textContent = row.innerText.toLowerCase();
            const matchesSearch = textContent.includes(searchTerm);
            return matchesSearch;
        });

        const totalItems = currentFilteredRows.length;
        const totalPages = Math.ceil(totalItems / rowsPerPage);

        if(totalItems === 0) {
            noResults.style.display = 'block';
            tableBody.innerHTML = ''; 
            paginationContainer.innerHTML = '';
            pageInfo.innerText = '0 entries';
            return;
        } else {
            noResults.style.display = 'none';
        }

        if (currentPage > totalPages) currentPage = 1;
        const startIndex = (currentPage - 1) * rowsPerPage;
        const endIndex = startIndex + rowsPerPage;
        const rowsToShow = currentFilteredRows.slice(startIndex, endIndex);

        tableBody.innerHTML = ''; 
        rowsToShow.forEach(row => tableBody.appendChild(row));
        renderPaginationControls(totalPages, totalItems, startIndex + 1, Math.min(endIndex, totalItems));
    }

    function renderPaginationControls(totalPages, totalItems, startItem, endItem) {
        pageInfo.innerText = `Showing ${startItem} to ${endItem} of ${totalItems} entries`;
        paginationContainer.innerHTML = '';

        const createBtn = (text, onClick, disabled, active) => {
            const btn = document.createElement('button');
            btn.className = `page-btn ${active ? 'active' : ''}`;
            btn.innerHTML = text;
            btn.disabled = disabled;
            btn.onclick = onClick;
            paginationContainer.appendChild(btn);
        };

        createBtn('&laquo;', () => { currentPage--; updateTableLogic(); }, currentPage === 1, false);
        
        let startPage = Math.max(1, currentPage - 1);
        let endPage = Math.min(totalPages, currentPage + 1);
        if(totalPages > 3) {
            if(currentPage === 1) endPage = 3;
            if(currentPage === totalPages) startPage = totalPages - 2;
        }

        for(let i = startPage; i <= endPage; i++) {
            createBtn(i, () => { currentPage = i; updateTableLogic(); }, false, i === currentPage);
        }

        createBtn('&raquo;', () => { currentPage++; updateTableLogic(); }, currentPage === totalPages, false);
    }

    searchInput.addEventListener('input', () => { currentPage = 1; updateTableLogic(); });
    rowsPerPageSelect.addEventListener('change', (e) => { rowsPerPage = parseInt(e.target.value); currentPage = 1; updateTableLogic(); });
    document.querySelector('.menu-toggle').addEventListener('click', () => { document.querySelector('.main-nav').classList.toggle('active'); });

    loadSheetData();
</script>

</body>
</html>
